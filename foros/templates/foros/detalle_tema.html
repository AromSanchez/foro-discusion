{% extends 'base.html' %}

{% block content %}
<div class="card mb-4 shadow-sm">
  <div class="card-body">
    <div class="d-flex justify-content-between align-items-start">
      <div>
        <h1 class="card-title">{{ tema.titulo }}</h1>
        <p class="text-muted mb-1">Por <strong>{{ tema.autor }}</strong></p>
        <small class="text-secondary">{{ tema.fecha }}</small>
      </div>
      <div class="text-end">
        <a href="{% url 'editar_tema' tema.pk %}" class="btn btn-sm btn-outline-secondary">Editar</a>
        <a href="{% url 'eliminar_tema' tema.pk %}" class="btn btn-sm btn-danger ms-2">Eliminar</a>
      </div>
    </div>

    {% if tema.imagen %}
      <div class="mt-3">
        <img src="{{ tema.imagen.url }}" class="img-fluid rounded" style="max-height:300px;">
      </div>
    {% endif %}

    <hr>
    <div class="d-flex justify-content-between align-items-center mb-2">
      <h5 class="mb-0">Respuestas</h5>
      <a href="{% url 'crear_respuesta' tema.id %}" class="btn btn-sm btn-primary">Agregar respuesta</a>
    </div>

    {% if tema.respuestas.count %}
      <div class="list-group">
        {% for r in tema.respuestas.all %}
          <div class="list-group-item">
            <div class="d-flex w-100 justify-content-between">
              <h6 class="mb-1">{{ r.autor }}</h6>
              <small class="text-muted">{{ r.fecha }}</small>
            </div>
            <p class="mb-1">{{ r.texto }}</p>
            <div class="mt-2">
              <a href="{% url 'editar_respuesta' r.pk %}" class="btn btn-sm btn-outline-secondary">Editar</a>
              <a href="{% url 'eliminar_respuesta' r.pk %}" class="btn btn-sm btn-outline-danger ms-2">Eliminar</a>
            </div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <div class="alert alert-info">No hay respuestas todavía. Sé el primero en responder.</div>
    {% endif %}

    <div class="mt-4">
      <a href="{% url 'lista_temas' %}" class="btn btn-link">Volver a la lista</a>
    </div>
  </div>
</div>

{% endblock %}
